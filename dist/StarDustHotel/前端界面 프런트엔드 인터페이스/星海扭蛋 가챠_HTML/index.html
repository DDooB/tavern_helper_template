<head><script type="module">const t={busy:!1,snapshot:null,api:null,activeTab:'normal',resultMessage:'ëŒ€ê¸°ì¤‘',lastResultPartner:null};function a(a){t.activeTab=a,$('.tab-btn').removeClass('is-active'),$(`.tab-btn[data-tab="${a}"]`).addClass('is-active'),$('.tab-panel').removeClass('is-active'),$(`.tab-panel[data-panel="${a}"]`).addClass('is-active')}function s(){$('button').prop('disabled',t.busy),$('input').prop('disabled',t.busy),$('select').prop('disabled',t.busy)}function e(){if($('#result-message').text(t.resultMessage),!t.lastResultPartner)return void $('#result-card').removeClass('active');const a=t.lastResultPartner;$('#result-name').text(`${a.Name} (${a.Grade})`),$('#result-meta').text(`Lv.${a.Level} | ${function(t){const a=t.trim().toLowerCase();return'tank'===a?'ğŸ›¡ï¸':'dps'===a?'âš”ï¸':'heal'===a||'healer'===a?'âœ¨':'support'===a?'ğŸŒ¿':'ğŸ’'}(a.Class)} ${a.Class} | ${a.Job}`),$('#result-card').addClass('active')}async function n(){t.api&&(t.snapshot=await t.api.getSnapshot(),function(t){if(!t)return;const a=t.stat?.User?.SDP??t.sdp;$('#stat-sdp').text(`SDP ${a.toLocaleString()}`),$('#stat-owned').text(`ë³´ìœ  ${t.ownedCount}`),$('#stat-pool').text(`í’€ ${t.poolCount}`),$('#hint-csv').text(`í˜„ì¬ URL: ${t.csvUrl||'(ë¯¸ì„¤ì •)'} | ë™ê¸°í™”: ${t.lastPoolSyncAt?new Date(t.lastPoolSyncAt).toLocaleString():'(ì—†ìŒ)'}`),$('#csv-url').val(t.csvUrl);const s=t.pool.map(t=>t.Name.trim()).filter(t=>''!==t).filter((t,a,s)=>s.indexOf(t)===a).slice(0,400).map(t=>{return`<option value="${a=t,a.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll('\'','&#39;')}"></option>`;var a}).join('');$('#pickup-suggestions').html(s)}(t.snapshot))}function l(a){if(!t.snapshot||!a.partnerName)return null;const s=a.partnerId?t.snapshot.ownedPartners.find(t=>t.Id===a.partnerId):void 0,e=t.snapshot.ownedPartners.find(t=>t.Name===a.partnerName),n=s??e;if(n)return{Name:n.Name,Level:n.Level,Grade:n.Grade,Class:n.Class,Job:n.Job};const l=t.snapshot.pool.find(t=>t.Id===a.partnerId||t.Name===a.partnerName);return l?{Name:l.Name,Level:1,Grade:l.Grade,Class:l.Class,Job:l.Job}:null}function o(t){const a=`ì†Œëª¨ ${t.spent} SDP`,s=t.refund>0?` / í™˜ê¸‰ ${t.refund} SDP`:'';return`${t.message} (${a}${s})`}async function i(a){if(!t.busy){t.busy=!0,s();try{await a()}catch(a){const s=a instanceof Error?a.message:String(a);t.resultMessage=`ì˜¤ë¥˜: ${s}`,t.lastResultPartner=null,e(),toastr.error(t.resultMessage)}finally{t.busy=!1,s()}}}$(async()=>{if($('#app').html('\n    <main class="page">\n      <section class="gacha-shell">\n        <header class="header">\n          <h1 class="title">STAR SEA GACHA</h1>\n          <p class="sub">í™•ë¥  ê¸°ë°˜ ì†Œí™˜ / íŒŒíŠ¸ë„ˆ ë“±ë¡</p>\n          <div class="status-row">\n            <span id="stat-sdp" class="pill">SDP 0</span>\n            <span id="stat-owned" class="pill">ë³´ìœ  0</span>\n            <span id="stat-pool" class="pill">í’€ 0</span>\n          </div>\n        </header>\n\n        <section class="csv-bar">\n          <input id="csv-url" class="input grow" placeholder="Google Spreadsheet CSV URL" />\n          <button id="btn-save-url" class="btn">URL ì €ì¥</button>\n          <button id="btn-reload-pool" class="btn alt">í’€ ë™ê¸°í™”</button>\n          <button id="btn-refresh" class="btn dark">ê°±ì‹ </button>\n        </section>\n        <p id="hint-csv" class="hint">í˜„ì¬ URL: (ë¯¸ì„¤ì •)</p>\n\n        <nav class="tab-nav" role="tablist" aria-label="ê°€ì±  ë°©ì‹">\n          <button class="tab-btn is-active" data-tab="normal" type="button">ì¼ë°˜ ê°€ì± </button>\n          <button class="tab-btn" data-tab="advanced" type="button">ê³ ê¸‰ ê°€ì± </button>\n          <button class="tab-btn" data-tab="pickup" type="button">í”½ì—… ê°€ì± </button>\n          <button class="tab-btn" data-tab="custom" type="button">ì»¤ìŠ¤í…€ ë“±ë¡</button>\n        </nav>\n\n        <section class="tab-panel is-active" data-panel="normal">\n          <h2 class="panel-title">ì¼ë°˜ ê°€ì± </h2>\n          <p class="rate">ë¹„ìš© 1,000 SDP | EX 0.1% / S 1% / A 5% / B 15% / C 30% / D 48.9%</p>\n          <button id="btn-draw-normal" class="btn">ì¼ë°˜ 1íšŒ ì†Œí™˜</button>\n        </section>\n\n        <section class="tab-panel" data-panel="advanced">\n          <h2 class="panel-title">ê³ ê¸‰ ê°€ì± </h2>\n          <p class="rate">ë¹„ìš© 5,000 SDP | EX 2% / S 8% / A 20% / B 30% / C 40% / D 0%</p>\n          <button id="btn-draw-advanced" class="btn">ê³ ê¸‰ 1íšŒ ì†Œí™˜</button>\n        </section>\n\n        <section class="tab-panel" data-panel="pickup">\n          <h2 class="panel-title">í”½ì—… ê°€ì± </h2>\n          <p class="rate">ë¹„ìš© 50,000 SDP | í’€ì— ìˆëŠ” ì´ë¦„ë§Œ ì§€ì • ê°€ëŠ¥</p>\n          <input id="pickup-name" class="input" list="pickup-suggestions" placeholder="íŒŒíŠ¸ë„ˆ ì´ë¦„ ì…ë ¥" />\n          <datalist id="pickup-suggestions"></datalist>\n          <div style="height:8px"></div>\n          <button id="btn-pickup" class="btn">í”½ì—… ì†Œí™˜</button>\n        </section>\n\n        <section class="tab-panel" data-panel="custom">\n          <h2 class="panel-title">ì»¤ìŠ¤í…€ íŒŒíŠ¸ë„ˆ ë“±ë¡</h2>\n          <p class="rate">ë¹„ìš© 10,000 SDP | Grade: EX,S,A,B,C,D | Class: tank,dps,heal,support,allRound</p>\n          <div class="form-grid">\n            <input id="custom-name" class="input" placeholder="ì´ë¦„" />\n            <input id="custom-id" class="input" placeholder="ID (ë¹„ìš°ë©´ ì´ë¦„ ì‚¬ìš©)" />\n            <select id="custom-grade" class="select">\n              <option value="D">D</option>\n              <option value="C">C</option>\n              <option value="B">B</option>\n              <option value="A">A</option>\n              <option value="S">S</option>\n              <option value="EX">EX</option>\n            </select>\n            <select id="custom-class" class="select">\n              <option value="tank">tank</option>\n              <option value="dps">dps</option>\n              <option value="heal">heal</option>\n              <option value="support" selected>support</option>\n              <option value="allRound">allRound</option>\n            </select>\n            <input id="custom-job" class="input" placeholder="ì§ì—…" />\n            <input id="custom-level" class="input" type="number" min="1" value="1" placeholder="ë ˆë²¨" />\n            <input id="custom-affinity" class="input" type="number" value="0" placeholder="í˜¸ê°ë„" />\n            <input id="custom-lovelevel" class="input" type="number" value="0" placeholder="ëŸ¬ë¸Œ ë ˆë²¨" />\n          </div>\n          <button id="btn-custom-register" class="btn">ì»¤ìŠ¤í…€ ë“±ë¡</button>\n        </section>\n\n        <section class="result-box">\n          <p id="result-message" class="result-message">ëŒ€ê¸°ì¤‘</p>\n          <div id="result-card" class="result-card">\n            <div id="result-name" class="result-name">-</div>\n            <div id="result-meta" class="result-meta">-</div>\n          </div>\n        </section>\n      </section>\n    </main>\n  '),$('.tab-btn').on('click',function(){a(String($(this).data('tab')))}),$('#btn-save-url').on('click',()=>{i(async()=>{t.api&&(await t.api.setPoolCsvUrl(String($('#csv-url').val()??'').trim()),await n(),t.resultMessage='CSV URL ì €ì¥ ì™„ë£Œ',t.lastResultPartner=null,e(),toastr.success(t.resultMessage))})}),$('#btn-reload-pool').on('click',()=>{i(async()=>{if(!t.api)return;const a=await t.api.refreshPoolFromCsv();await n(),t.resultMessage=a.message,t.lastResultPartner=null,e(),a.ok?toastr.success(t.resultMessage):toastr.warning(t.resultMessage)})}),$('#btn-refresh').on('click',()=>{i(async()=>{await n(),t.resultMessage='ìƒíƒœ ê°±ì‹  ì™„ë£Œ',t.lastResultPartner=null,e(),toastr.info(t.resultMessage)})}),$('#btn-draw-normal').on('click',()=>{i(async()=>{if(!t.api)return;const a=await t.api.drawGacha('normal');await n(),t.resultMessage=o(a),t.lastResultPartner=l(a),e(),a.ok?toastr.success(t.resultMessage):toastr.warning(t.resultMessage)})}),$('#btn-draw-advanced').on('click',()=>{i(async()=>{if(!t.api)return;const a=await t.api.drawGacha('advanced');await n(),t.resultMessage=o(a),t.lastResultPartner=l(a),e(),a.ok?toastr.success(t.resultMessage):toastr.warning(t.resultMessage)})}),$('#btn-pickup').on('click',()=>{i(async()=>{if(!t.api)return;const a=await t.api.pickupByName(String($('#pickup-name').val()??'').trim());await n(),t.resultMessage=o(a),t.lastResultPartner=l(a),e(),a.ok?toastr.success(t.resultMessage):toastr.warning(t.resultMessage)})}),$('#btn-custom-register').on('click',()=>{i(async()=>{if(!t.api)return;const a={Id:String($('#custom-id').val()??'').trim()||String($('#custom-name').val()??'').trim(),Name:String($('#custom-name').val()??'').trim(),Grade:String($('#custom-grade').val()??'D').trim(),Class:String($('#custom-class').val()??'support').trim(),Job:String($('#custom-job').val()??'').trim()||'ë¯¸ì •',Level:Number($('#custom-level').val()??1),Affinity:Number($('#custom-affinity').val()??0),LoveLevel:Number($('#custom-lovelevel').val()??0)},s=await t.api.registerCustomPartner(a);await n(),t.resultMessage=o(s),t.lastResultPartner=l(s),e(),s.ok?toastr.success(t.resultMessage):toastr.warning(t.resultMessage)})}),a('normal'),e(),t.resultMessage='SDH API ì—°ê²° ì¤‘...',e(),t.api=await async function(){for(let t=0;t<30;t+=1){const t=window.top.SDH??window.SDH;if(t)return t;await new Promise(t=>setTimeout(t,200))}return null}(),!t.api)return t.resultMessage='SDH íŒŒíŠ¸ë„ˆ ì‹œìŠ¤í…œ APIë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.',e(),void toastr.error(t.resultMessage);await n(),t.resultMessage='ì¤€ë¹„ ì™„ë£Œ',e()});
//# sourceMappingURL=index.js.map</script><style>:root{--bg-main:#171927;--bg-card:#1a1a2e;--bg-panel:#22253a;--line-gold:#c9a45c;--text-main:#e0e0e0;--text-sub:#9aa5c7;--text-gold:#e7c987;--accent-blue:#7aa2f7;--accent-red:#f7768e}*{box-sizing:border-box}body{margin:0;font-family:'Cinzel','Pretendard','Noto Sans KR',sans-serif;color:var(--text-main);background:radial-gradient(1000px 600px at 80% -20%,rgba(201,164,92,0.12),rgba(201,164,92,0)),radial-gradient(900px 500px at -15% 120%,rgba(122,162,247,0.16),rgba(122,162,247,0)),linear-gradient(180deg,#121523,#171a2a 60%,#111423)}.page{min-height:100vh;padding:16px}.gacha-shell{max-width:720px;margin:0 auto;background:linear-gradient(135deg,var(--bg-card),#1a2136);border:2px solid var(--line-gold);border-radius:10px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,0.45),inset 0 0 16px rgba(201,164,92,0.08)}.header{text-align:center;border-bottom:1px solid rgba(201,164,92,0.35);padding-bottom:10px;margin-bottom:10px}.title{margin:0;color:var(--text-gold);letter-spacing:0.08em;font-size:1.15rem}.sub{margin:4px 0 0 0;color:var(--text-sub);font-size:0.82rem}.status-row{margin-top:8px;display:flex;justify-content:center;gap:8px;flex-wrap:wrap}.pill{border:1px solid rgba(201,164,92,0.45);background:rgba(0,0,0,0.25);border-radius:999px;padding:4px 9px;font-size:0.78rem;color:#e7d2a1}.csv-bar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}.input,.select{min-height:34px;border:1px solid #4e587e;border-radius:5px;background:rgba(12,15,27,0.9);color:#dbe4ff;padding:6px 8px;font-size:0.83rem;font-family:inherit}.input::placeholder{color:#808bb2}.input.grow{flex:1;min-width:220px}.btn{border:1px solid var(--line-gold);border-radius:5px;background:linear-gradient(180deg,#d3b273,#b9964e);color:#1a1a2e;font-weight:700;cursor:pointer;padding:7px 10px;font-size:0.8rem;font-family:inherit}.btn.alt{background:linear-gradient(180deg,#89a8f3,#6288e6);border-color:#89a8f3;color:#0f1327}.btn.dark{background:rgba(14,18,31,0.9);border-color:#48537a;color:#b3c1e8}.btn:disabled{opacity:0.55;cursor:not-allowed}.hint{margin:0 0 8px 0;color:var(--text-sub);font-size:0.75rem}.tab-nav{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));border:1px solid rgba(201,164,92,0.38);border-radius:6px;overflow:hidden;margin-bottom:8px}.tab-btn{border:none;border-right:1px solid rgba(201,164,92,0.2);background:rgba(16,20,34,0.88);color:#8f9bc0;padding:9px 6px;font-family:inherit;font-size:0.8rem;cursor:pointer}.tab-btn:last-child{border-right:none}.tab-btn.is-active{background:linear-gradient(180deg,#d2b06f,#bd9a54);color:#1a1a2e;font-weight:700}.tab-panel{display:none;background:rgba(0,0,0,0.25);border:1px solid rgba(201,164,92,0.24);border-radius:6px;padding:10px}.tab-panel.is-active{display:block}.panel-title{margin:0;color:#ffffff;font-size:0.95rem}.rate{margin:6px 0 10px 0;color:#b3c1e8;font-size:0.8rem;line-height:1.45}.form-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px;margin-bottom:8px}.result-box{margin-top:10px;background:rgba(0,0,0,0.32);border:1px dashed rgba(201,164,92,0.35);border-radius:6px;padding:10px}.result-message{margin:0 0 8px 0;color:#d9c08d;font-size:0.82rem}.result-card{display:none;background:var(--bg-panel);border-left:4px solid #c9a45c;border-radius:4px;padding:8px}.result-card.active{display:block}.result-name{color:#fff;font-weight:700;font-size:0.92rem}.result-meta{margin-top:4px;color:#b7c3e7;font-size:0.8rem}@media (max-width:760px){.tab-nav{grid-template-columns:repeat(2,minmax(0,1fr))}.form-grid{grid-template-columns:1fr}}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>