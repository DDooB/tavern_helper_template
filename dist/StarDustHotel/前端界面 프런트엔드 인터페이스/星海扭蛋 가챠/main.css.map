{"version":3,"file":"main.css","mappings":"AAuVA,uBACE,iBAAkB,CAClB,iBAAkB,CAClB,gBAAiB,CACjB,gBAAiB,CACjB,gBAAiB,CACjB,eACF,CAEA,uBACE,gBAAiB,CACjB,YAAa,CACb,kBAAmB,CACnB,oNAIF,CAEA,4BACE,cAAe,CACf,OAAQ,CACR,mBAAoB,CACpB,YAAa,CACb,oVAMF,CAEA,uBACE,iBAAkB,CAClB,uBAAwB,CACxB,gBAAiB,CACjB,kBAAmB,CACnB,qCAAyC,CACzC,gCAAoC,CACpC,gFAEmC,CACnC,YACF,CAEA,+BACE,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,kBAAmB,CACnB,sCAA0C,CAC1C,mBACF,CAEA,4BACE,kBAAmB,CACnB,cAAe,CACf,qBAAsB,CACtB,aACF,CAEA,sBACE,QAAS,CACT,aACF,CAEA,wBACE,eAAgB,CAChB,YAAa,CACb,QAAS,CACT,cACF,CAEA,6BACE,iCAAqC,CACrC,aAAc,CACd,qCAAyC,CACzC,gBAAiB,CACjB,mBACF,CAEA,sBACE,YAAa,CACb,QAAS,CACT,cACF,CAEA,wBACE,YAAa,CACb,6CAAgD,CAChD,QACF,CAEA,wBACE,YAAa,CACb,6CAAgD,CAChD,QACF,CAEA,yBACE,YAAa,CACb,6CAAgD,CAChD,QACF,CAEA,wBACE,iCAAqC,CACrC,qCAAyC,CACzC,aAAc,CACd,kBAAmB,CACnB,gBAAiB,CACjB,eACF,CAEA,6BACE,MAAO,CACP,eACF,CAEA,sBACE,oCAAwC,CACxC,kDAAqD,CACrD,aAAc,CACd,kBAAmB,CACnB,gBAAiB,CACjB,cACF,CAEA,2BACE,kDACF,CAEA,2BACE,UACF,CAEA,+BACE,YAAa,CACb,kBACF,CAEA,4BACE,kBAAmB,CACnB,qCAAyC,CACzC,YAAa,CACb,+EACF,CAEA,+BACE,gBACF,CAEA,uBACE,aAAc,CACd,cACF,CAEA,uBACE,aAAc,CACd,gBACF,CAEA,yBACE,iBAAkB,CAClB,aAAc,CACd,eACF,CAEA,uBACE,QAAS,CACT,SAAU,CACV,eAAgB,CAChB,gBAAiB,CACjB,aAAc,CACd,qCAAyC,CACzC,kBAAmB,CACnB,iCACF,CAEA,0BACE,gBAAiB,CACjB,4CAAgD,CAChD,cACF,CAEA,qCACE,kBACF,CAEA,yBACE,wBACE,yBACF,CAEA,yBACE,yBACF,CAEA,wBACE,yBACF,CACF","sources":["src://tavern_helper_template/src/StarDustHotel/前端界面 프런트엔드 인터페이스/星海扭蛋 가챠/App.vue"],"sourcesContent":["<template>\n  <main class=\"page\">\n    <div class=\"starfield\"></div>\n    <section class=\"card header\">\n      <h1>Stardust Gacha Console</h1>\n      <p class=\"sub\">상아색 성운 UI · 황금 장식 · 파트너 소환 및 등록</p>\n      <div class=\"stats\">\n        <span>SP: {{ snapshot?.sdp ?? 0 }}</span>\n        <span>소지 파트너: {{ snapshot?.ownedCount ?? 0 }}</span>\n        <span>파티: {{ snapshot?.inPartyCount ?? 0 }}/3</span>\n        <span>풀 인원: {{ snapshot?.poolCount ?? 0 }}</span>\n      </div>\n    </section>\n\n    <section class=\"card\">\n      <h2>가챠 풀 CSV</h2>\n      <div class=\"row\">\n        <input v-model.trim=\"csvUrl\" class=\"input grow\" placeholder=\"Google Spreadsheet CSV URL\" />\n        <button class=\"btn gold\" :disabled=\"busy\" @click=\"saveCsvUrl\">URL 저장</button>\n        <button class=\"btn\" :disabled=\"busy\" @click=\"reloadPool\">풀 새로고침</button>\n      </div>\n      <p class=\"hint\">현재 URL: {{ snapshot?.csvUrl || '(미설정)' }}</p>\n      <p class=\"hint\">\n        마지막 동기화:\n        {{ snapshot?.lastPoolSyncAt ? new Date(snapshot.lastPoolSyncAt).toLocaleString() : '(없음)' }}\n      </p>\n    </section>\n\n    <section class=\"card grid3\">\n      <article class=\"gacha-box\">\n        <h3>일반 가챠</h3>\n        <p>비용: 1,000 SP</p>\n        <p class=\"rate\">EX 0.1 / S 1 / A 5 / B 15 / C 30 / D 48.9 (%)</p>\n        <button class=\"btn wide\" :disabled=\"busy\" @click=\"draw('normal')\">일반 1회</button>\n      </article>\n\n      <article class=\"gacha-box\">\n        <h3>고급 가챠</h3>\n        <p>비용: 5,000 SP</p>\n        <p class=\"rate\">EX 2 / S 8 / A 20 / B 30 / C 40 / D 0 (%)</p>\n        <button class=\"btn wide\" :disabled=\"busy\" @click=\"draw('advanced')\">고급 1회</button>\n      </article>\n\n      <article class=\"gacha-box\">\n        <h3>픽업 가챠</h3>\n        <p>비용: 50,000 SP</p>\n        <input v-model.trim=\"pickupName\" class=\"input\" placeholder=\"풀에 있는 파트너 이름\" />\n        <button class=\"btn wide\" :disabled=\"busy\" @click=\"pickup\">픽업 소환</button>\n      </article>\n    </section>\n\n    <section class=\"card\">\n      <h2>커스텀 파트너 등록 (10,000 SP)</h2>\n      <div class=\"grid2\">\n        <input v-model.trim=\"custom.name\" class=\"input\" placeholder=\"이름\" />\n        <input v-model.trim=\"custom.id\" class=\"input\" placeholder=\"ID (비우면 이름 기반 생성)\" />\n        <input v-model.trim=\"custom.className\" class=\"input\" placeholder=\"클래스 (자유 입력)\" />\n        <input v-model.trim=\"custom.grade\" class=\"input\" placeholder=\"등급 (자유 입력)\" />\n        <input v-model.trim=\"custom.job\" class=\"input\" placeholder=\"직업\" />\n        <input v-model.number=\"custom.level\" class=\"input\" type=\"number\" min=\"1\" placeholder=\"레벨\" />\n        <input v-model.number=\"custom.affinity\" class=\"input\" type=\"number\" placeholder=\"호감도\" />\n        <input v-model.number=\"custom.loveLevel\" class=\"input\" type=\"number\" placeholder=\"러브 레벨\" />\n      </div>\n      <button class=\"btn gold wide\" :disabled=\"busy\" @click=\"registerCustom\">커스텀 등록</button>\n    </section>\n\n    <section class=\"card\">\n      <h2>파티 편성</h2>\n      <div class=\"row\">\n        <input v-model.trim=\"partyPartnerId\" class=\"input\" placeholder=\"파트너 ID\" />\n        <select v-model=\"partySlot\" class=\"input\">\n          <option value=\"\">자동 슬롯</option>\n          <option value=\"Slot1\">Slot1</option>\n          <option value=\"Slot2\">Slot2</option>\n          <option value=\"Slot3\">Slot3</option>\n        </select>\n        <button class=\"btn\" :disabled=\"busy\" @click=\"assignParty\">편성</button>\n        <button class=\"btn\" :disabled=\"busy\" @click=\"removeParty\">해제</button>\n      </div>\n      <p class=\"hint\">\n        현재 슬롯:\n        Slot1={{ snapshot?.partySlots.Slot1 || '-' }},\n        Slot2={{ snapshot?.partySlots.Slot2 || '-' }},\n        Slot3={{ snapshot?.partySlots.Slot3 || '-' }}\n      </p>\n    </section>\n\n    <section class=\"card\">\n      <h2>최근 결과</h2>\n      <p class=\"result\">{{ lastResult }}</p>\n      <button class=\"btn\" :disabled=\"busy\" @click=\"refreshSnapshot\">새로고침</button>\n    </section>\n\n    <section class=\"card tables\">\n      <div>\n        <h3>가챠 풀 (상위 30)</h3>\n        <ul class=\"list\">\n          <li v-for=\"item in poolPreview\" :key=\"item.Id\">\n            {{ item.Name }} · {{ item.Grade }} · {{ item.Class }} · {{ item.Id }}\n          </li>\n        </ul>\n      </div>\n      <div>\n        <h3>소지 파트너 (상위 30)</h3>\n        <ul class=\"list\">\n          <li v-for=\"item in ownedPreview\" :key=\"item.Id\">\n            {{ item.Name }} · Lv{{ item.Level }} · {{ item.Grade }} · {{ item.InParty ? 'Party' : 'Standby' }}\n          </li>\n        </ul>\n      </div>\n    </section>\n  </main>\n</template>\n\n<script setup lang=\"ts\">\ntype PartySlot = 'Slot1' | 'Slot2' | 'Slot3';\ntype DrawType = 'normal' | 'advanced';\n\ntype DrawResult = {\n  ok: boolean;\n  code: string;\n  message: string;\n  spent: number;\n  refund: number;\n  partnerId?: string;\n  partnerName?: string;\n  isDuplicate?: boolean;\n};\n\ntype PoolPartner = {\n  Id: string;\n  Name: string;\n  Grade: string;\n  Class: string;\n  Job: string;\n  BriefKey: string;\n  DetailKey: string;\n};\n\ntype Snapshot = {\n  sdp: number;\n  ownedCount: number;\n  inPartyCount: number;\n  poolCount: number;\n  csvUrl: string;\n  lastPoolSyncAt: number;\n  partySlots: Record<PartySlot, string>;\n  pool: PoolPartner[];\n  ownedPartners: Array<{\n    Id: string;\n    Name: string;\n    Grade: string;\n    Class: string;\n    Job: string;\n    InParty: boolean;\n    Alive: boolean;\n    Level: number;\n  }>;\n};\n\ntype SdhApi = {\n  getSnapshot: () => Promise<Snapshot>;\n  setPoolCsvUrl: (url: string) => Promise<void>;\n  refreshPoolFromCsv: () => Promise<{ ok: boolean; message: string; count: number }>;\n  drawGacha: (drawType: DrawType) => Promise<DrawResult>;\n  pickupByName: (name: string) => Promise<DrawResult>;\n  registerCustomPartner: (input: {\n    Id: string;\n    Name: string;\n    Grade: string;\n    Class: string;\n    Job: string;\n    Level?: number;\n    Affinity?: number;\n    LoveLevel?: number;\n  }) => Promise<DrawResult>;\n  addPartnerToParty: (partnerId: string, slot?: PartySlot) => Promise<boolean>;\n  removePartnerFromParty: (partnerIdOrSlot: string) => Promise<boolean>;\n};\n\nconst busy = ref(false);\nconst snapshot = ref<Snapshot | null>(null);\nconst csvUrl = ref('');\nconst pickupName = ref('');\nconst lastResult = ref('대기중');\nconst partyPartnerId = ref('');\nconst partySlot = ref('');\n\nconst custom = ref({\n  name: '',\n  id: '',\n  className: '',\n  grade: '',\n  job: '',\n  level: 1,\n  affinity: 0,\n  loveLevel: 0,\n});\n\nconst poolPreview = computed(() => (snapshot.value?.pool ?? []).slice(0, 30));\nconst ownedPreview = computed(() => (snapshot.value?.ownedPartners ?? []).slice(0, 30));\n\nasync function resolveApi(): Promise<SdhApi | null> {\n  for (let i = 0; i < 30; i += 1) {\n    const host = (window.top as Window & { SDH?: SdhApi }).SDH ?? (window as Window & { SDH?: SdhApi }).SDH;\n    if (host) return host;\n    await new Promise(resolve => setTimeout(resolve, 200));\n  }\n  return null;\n}\n\nlet api: SdhApi | null = null;\n\nasync function refreshSnapshot(): Promise<void> {\n  if (!api) return;\n  snapshot.value = await api.getSnapshot();\n  csvUrl.value = snapshot.value.csvUrl;\n}\n\nfunction renderResult(result: DrawResult): string {\n  const costText = `소모 ${result.spent} SP`;\n  const refundText = result.refund > 0 ? ` / 환급 ${result.refund} SP` : '';\n  const partnerText = result.partnerName ? ` / 대상 ${result.partnerName}` : '';\n  return `${result.message} (${costText}${refundText}${partnerText})`;\n}\n\nasync function runAction(task: () => Promise<void>): Promise<void> {\n  if (busy.value) return;\n  busy.value = true;\n  try {\n    await task();\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    lastResult.value = `오류: ${message}`;\n    toastr.error(lastResult.value);\n  } finally {\n    busy.value = false;\n  }\n}\n\nasync function saveCsvUrl(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    await api!.setPoolCsvUrl(csvUrl.value);\n    await refreshSnapshot();\n    lastResult.value = 'CSV URL 저장 완료';\n    toastr.success(lastResult.value);\n  });\n}\n\nasync function reloadPool(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const result = await api!.refreshPoolFromCsv();\n    lastResult.value = result.message;\n    if (result.ok) toastr.success(result.message);\n    else toastr.warning(result.message);\n    await refreshSnapshot();\n  });\n}\n\nasync function draw(type: DrawType): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const result = await api!.drawGacha(type);\n    lastResult.value = renderResult(result);\n    if (result.ok) toastr.success(lastResult.value);\n    else toastr.warning(lastResult.value);\n    await refreshSnapshot();\n  });\n}\n\nasync function pickup(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const result = await api!.pickupByName(pickupName.value);\n    lastResult.value = renderResult(result);\n    if (result.ok) toastr.success(lastResult.value);\n    else toastr.warning(lastResult.value);\n    await refreshSnapshot();\n  });\n}\n\nasync function registerCustom(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const payload = {\n      Id: custom.value.id.trim() || custom.value.name.trim(),\n      Name: custom.value.name.trim(),\n      Grade: custom.value.grade.trim() || 'D',\n      Class: custom.value.className.trim() || 'support',\n      Job: custom.value.job.trim() || '미정',\n      Level: Number(custom.value.level),\n      Affinity: Number(custom.value.affinity),\n      LoveLevel: Number(custom.value.loveLevel),\n    };\n    const result = await api!.registerCustomPartner(payload);\n    lastResult.value = renderResult(result);\n    if (result.ok) toastr.success(lastResult.value);\n    else toastr.warning(lastResult.value);\n    await refreshSnapshot();\n  });\n}\n\nasync function assignParty(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const ok = await api!.addPartnerToParty(partyPartnerId.value, (partySlot.value as PartySlot) || undefined);\n    lastResult.value = ok ? '파티 편성 완료' : '파티 편성 실패';\n    if (ok) toastr.success(lastResult.value);\n    else toastr.warning(lastResult.value);\n    await refreshSnapshot();\n  });\n}\n\nasync function removeParty(): Promise<void> {\n  if (!api) return;\n  await runAction(async () => {\n    const token = partyPartnerId.value.trim() || partySlot.value.trim();\n    if (!token) {\n      toastr.warning('해제 대상 ID 또는 슬롯을 입력하세요.');\n      return;\n    }\n    const ok = await api!.removePartnerFromParty(token);\n    lastResult.value = ok ? '파티 해제 완료' : '파티 해제 실패';\n    if (ok) toastr.success(lastResult.value);\n    else toastr.warning(lastResult.value);\n    await refreshSnapshot();\n  });\n}\n\nonMounted(async () => {\n  api = await resolveApi();\n  if (!api) {\n    lastResult.value = 'SDH 파트너 스크립트를 찾지 못했습니다.';\n    toastr.error(lastResult.value);\n    return;\n  }\n  await refreshSnapshot();\n});\n</script>\n\n<style scoped>\n:root {\n  --ivory-0: #fffdf5;\n  --ivory-1: #f5efdf;\n  --gold-0: #9f6b00;\n  --gold-1: #d9b24a;\n  --gold-2: #f5d98c;\n  --ink-0: #1f1d18;\n}\n\n.page {\n  min-height: 100vh;\n  padding: 20px;\n  color: var(--ink-0);\n  background:\n    radial-gradient(1200px 900px at 85% -10%, #2f2a4d 0%, rgba(47, 42, 77, 0) 70%),\n    radial-gradient(900px 700px at -10% 110%, #223047 0%, rgba(34, 48, 71, 0) 65%),\n    linear-gradient(180deg, var(--ivory-0), var(--ivory-1));\n}\n\n.starfield {\n  position: fixed;\n  inset: 0;\n  pointer-events: none;\n  opacity: 0.22;\n  background-image:\n    radial-gradient(circle at 8% 15%, #ffffff 0 1px, transparent 2px),\n    radial-gradient(circle at 28% 42%, #fff7c2 0 1px, transparent 2px),\n    radial-gradient(circle at 70% 30%, #ffffff 0 1px, transparent 2px),\n    radial-gradient(circle at 90% 65%, #fff0a8 0 1px, transparent 2px),\n    radial-gradient(circle at 44% 80%, #ffffff 0 1px, transparent 2px);\n}\n\n.card {\n  position: relative;\n  margin: 0 auto 14px auto;\n  max-width: 1100px;\n  border-radius: 16px;\n  border: 1px solid rgba(159, 107, 0, 0.25);\n  background: rgba(255, 252, 242, 0.9);\n  box-shadow:\n    inset 0 0 0 1px rgba(245, 217, 140, 0.25),\n    0 10px 30px rgba(37, 28, 9, 0.12);\n  padding: 16px;\n}\n\n.card::before {\n  content: '';\n  position: absolute;\n  inset: 8px;\n  border-radius: 10px;\n  border: 1px solid rgba(217, 178, 74, 0.26);\n  pointer-events: none;\n}\n\n.header h1 {\n  margin: 2px 0 6px 0;\n  font-size: 28px;\n  letter-spacing: 0.04em;\n  color: #5d4100;\n}\n\n.sub {\n  margin: 0;\n  color: #685633;\n}\n\n.stats {\n  margin-top: 10px;\n  display: flex;\n  gap: 12px;\n  flex-wrap: wrap;\n}\n\n.stats span {\n  background: rgba(245, 217, 140, 0.35);\n  color: #47360e;\n  border: 1px solid rgba(159, 107, 0, 0.25);\n  padding: 4px 10px;\n  border-radius: 999px;\n}\n\n.row {\n  display: flex;\n  gap: 10px;\n  flex-wrap: wrap;\n}\n\n.grid3 {\n  display: grid;\n  grid-template-columns: repeat(3, minmax(0, 1fr));\n  gap: 12px;\n}\n\n.grid2 {\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  gap: 10px;\n}\n\n.tables {\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  gap: 12px;\n}\n\n.input {\n  background: rgba(255, 250, 235, 0.96);\n  border: 1px solid rgba(159, 107, 0, 0.35);\n  color: #2f2715;\n  border-radius: 10px;\n  padding: 8px 10px;\n  min-height: 36px;\n}\n\n.input.grow {\n  flex: 1;\n  min-width: 260px;\n}\n\n.btn {\n  border: 1px solid rgba(159, 107, 0, 0.5);\n  background: linear-gradient(180deg, #fff8e2, #f8e5b1);\n  color: #3d2c08;\n  border-radius: 10px;\n  padding: 8px 12px;\n  cursor: pointer;\n}\n\n.btn.gold {\n  background: linear-gradient(180deg, #f7dc9b, #d7ab3f);\n}\n\n.btn.wide {\n  width: 100%;\n}\n\n.btn:disabled {\n  opacity: 0.55;\n  cursor: not-allowed;\n}\n\n.gacha-box {\n  border-radius: 12px;\n  border: 1px solid rgba(159, 107, 0, 0.28);\n  padding: 12px;\n  background: linear-gradient(165deg, rgba(255, 248, 224, 0.95), rgba(248, 235, 187, 0.6));\n}\n\n.gacha-box h3 {\n  margin: 0 0 4px 0;\n}\n\n.rate {\n  color: #5f4f2c;\n  font-size: 13px;\n}\n\n.hint {\n  color: #6f5f3d;\n  margin: 6px 0 0 0;\n}\n\n.result {\n  margin: 0 0 10px 0;\n  color: #4a3912;\n  font-weight: 600;\n}\n\n.list {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  max-height: 280px;\n  overflow: auto;\n  border: 1px solid rgba(159, 107, 0, 0.22);\n  border-radius: 10px;\n  background: rgba(255, 248, 229, 0.72);\n}\n\n.list li {\n  padding: 7px 10px;\n  border-bottom: 1px solid rgba(159, 107, 0, 0.12);\n  font-size: 13px;\n}\n\n.list li:last-child {\n  border-bottom: none;\n}\n\n@media (max-width: 980px) {\n  .grid3 {\n    grid-template-columns: 1fr;\n  }\n\n  .tables {\n    grid-template-columns: 1fr;\n  }\n\n  .grid2 {\n    grid-template-columns: 1fr;\n  }\n}\n</style>\n"],"names":[],"sourceRoot":""}