import{registerMvuSchema as r}from'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';const t=z,e=['EX','S','A','B','C','D'];function n(r){const t=r.trim().toUpperCase();return e.includes(t)?t:'D'}function o(r){const t=r.trim().toLowerCase();return'tank'===t?'tank':'dps'===t?'dps':'heal'===t||'healer'===t?'heal':'support'===t?'support':'allround'===t||'all_round'===t||'all-round'===t||'allrounder'===t||'all-rounder'===t?'allRound':'support'}const a=t.z.object({User:t.z.object({Level:t.z.coerce.number().transform(r=>Math.max(1,Math.trunc(r))),Costume:t.z.string(),SDP:t.z.coerce.number().transform(r=>Math.max(0,Math.trunc(r))),Inventory:t.z.record(t.z.string().describe('Item ID'),t.z.object({Description:t.z.string(),Quantity:t.z.coerce.number().transform(r=>Math.max(0,Math.trunc(r)))})),PartySlots:t.z.record(t.z.enum(['Slot1','Slot2','Slot3']),t.z.string()),PartySlotData:t.z.record(t.z.enum(['Slot1','Slot2','Slot3']),t.z.union([t.z.literal(''),t.z.object({PartnerId:t.z.string(),Name:t.z.string(),Level:t.z.coerce.number().transform(r=>Math.max(1,Math.trunc(r))),Grade:t.z.string().transform(r=>n(r)),Class:t.z.string().transform(r=>o(r)),Job:t.z.string(),Affinity:t.z.coerce.number().transform(r=>Math.trunc(r)),LoveLevel:t.z.coerce.number().transform(r=>_.clamp(Math.trunc(r),-5,5)),Fatigue:t.z.coerce.number().transform(r=>_.clamp(Math.trunc(r),0,100)),Alive:t.z.boolean()})])),_OwnedPartnerCount:t.z.coerce.number().transform(r=>Math.max(0,Math.trunc(r)))}),Mission:t.z.object({OnMission:t.z.boolean(),MissionType:t.z.enum(['normal','eros']),MissionGrade:t.z.enum(['S','A','B','C','D']),WorldName:t.z.string(),WorldSummaryAndObjective:t.z.string()})}).transform(r=>{const t=['Slot1','Slot2','Slot3'],e=[];for(const n of t){const t=r.User.PartySlots[n].trim();''===t||e.includes(t)||e.push(t)}return t.forEach((t,a)=>{const s=e[a]??'';r.User.PartySlots[t]=s;const i=r.User.PartySlotData[t];if(''===s||''===i)return void(r.User.PartySlotData[t]='');let l=Math.trunc(i.Affinity),c=_.clamp(Math.trunc(i.LoveLevel),-5,5);for(;l>=100&&c<5;)l-=100,c+=1;for(;l<=-100&&c>-5;)l+=100,c-=1;r.User.PartySlotData[t]={...i,PartnerId:s,Level:Math.max(1,Math.trunc(i.Level)),Grade:n(i.Grade),Class:o(i.Class),Affinity:_.clamp(l,-99,99),LoveLevel:_.clamp(c,-5,5),Fatigue:_.clamp(Math.trunc(i.Fatigue),0,100)}}),r.User._OwnedPartnerCount=Math.max(0,Math.trunc(r.User._OwnedPartnerCount)),r.Mission.OnMission?(''===r.Mission.WorldName.trim()&&(r.Mission.WorldName='스타더스트 호텔'),''===r.Mission.WorldSummaryAndObjective.trim()&&(r.Mission.WorldSummaryAndObjective='임무 진행중')):(r.Mission.MissionType='normal',r.Mission.MissionGrade='D',r.Mission.WorldName='스타더스트 호텔',r.Mission.WorldSummaryAndObjective='대기중'),r});$(()=>{r(a)});
//# sourceMappingURL=index.js.map